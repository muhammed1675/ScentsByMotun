<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Login - ScentsBymotun" />
    <title>Login - ScentsBymotun</title>
    <link rel="stylesheet" href="../css/style.css" />
    <script src="https://js.paystack.co/v1/inline.js"></script>
  </head>
  <body>
    <!-- Header & Navigation -->
    <header>
      <div class="container">
        <nav class="flex justify-between items-center">
          <a href="../index.html" class="logo">ScentsBymotun</a>

          <ul class="nav-menu">
            <li><a href="../index.html">Home</a></li>
            <li><a href="shop.html">Shop</a></li>
            <li><a href="../index.html#contact">Contact</a></li>
          </ul>

          <div class="nav-actions">
            <a href="cart.html" class="cart-icon" title="Shopping Cart">
              üõçÔ∏è
              <span class="cart-count" id="cart-count" style="display: none">0</span>
            </a>
          </div>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main>
      <section>
        <div class="container-sm">
          <h1 style="text-align: center; margin-bottom: 2rem">Login to Your Account</h1>

          <div class="card p-6">
            <!-- Error Message -->
            <div id="error-message" style="display: none" class="alert alert-error mb-4"></div>

            <!-- Loading State -->
            <div id="loading-state" style="display: none; text-align: center; padding: 2rem">
              <p>Logging in...</p>
            </div>

            <!-- Form -->
            <form id="login-form" style="display: block">
              <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required placeholder="you@example.com" />
              </div>

              <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              </div>

              <button type="submit" class="btn btn-gold btn-lg btn-block mb-3">Login</button>

              <p style="text-align: center; color: var(--text-secondary)">
                Don't have an account?
                <a href="signup.html" style="color: var(--secondary); font-weight: 600">Sign up here</a>
              </p>

              <p style="text-align: center; color: var(--text-secondary); margin-top: 1rem; font-size: 0.875rem">
                <a href="../index.html" style="color: var(--secondary)">‚Üê Back to home</a>
              </p>
            </form>
          </div>

          <!-- Info Section -->
          <div class="card p-4 mt-4" style="background-color: var(--bg-secondary)">
            <h3 style="margin-bottom: 1rem">Demo Credentials</h3>
            <p style="margin: 0.5rem 0">Email: <code style="background-color: var(--bg-primary); padding: 0.25rem 0.5rem; border-radius: 4px">demo@example.com</code></p>
            <p style="margin: 0">Password: <code style="background-color: var(--bg-primary); padding: 0.25rem 0.5rem; border-radius: 4px">password123</code></p>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer style="margin-top: 4rem">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h4>ScentsBymotun</h4>
            <p>Premium luxury fragrances for the discerning individual.</p>
          </div>

          <div class="footer-section">
            <h4>Quick Links</h4>
            <a href="shop.html">Shop</a>
            <a href="#about">About Us</a>
            <a href="#returns">Returns</a>
          </div>

          <div class="footer-section">
            <h4>Customer Service</h4>
            <a href="mailto:support@scentsbymotun.com">Email Support</a>
            <a href="tel:+2341234567890">Call Us</a>
            <a href="#faq">FAQ</a>
          </div>

          <div class="footer-section">
            <h4>Follow Us</h4>
            <div class="social-links">
              <a href="https://instagram.com/scentsbymotun" target="_blank" title="Instagram">üì∑</a>
              <a href="https://twitter.com/scentsbymotun" target="_blank" title="Twitter">ùïè</a>
              <a href="https://facebook.com/scentsbymotun" target="_blank" title="Facebook">f</a>
            </div>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; 2024 ScentsBymotun. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script type="module">
      import { auth } from '../js/auth.js';
      import { cart } from '../js/cart.js';

      // [v0] Initialize login page
      console.log('[v0] Login page initializing');

      const form = document.getElementById('login-form');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        try {
          document.getElementById('login-form').style.display = 'none';
          document.getElementById('loading-state').style.display = 'block';
          document.getElementById('error-message').style.display = 'none';

          await auth.signIn(email, password);

          console.log('[v0] Login successful');

          // Redirect to cart or home
          const redirectPath = sessionStorage.getItem('redirect_after_login') || 'cart.html';
          sessionStorage.removeItem('redirect_after_login');
          window.location.href = redirectPath;
        } catch (error) {
          console.error('[v0] Login error:', error);

          document.getElementById('login-form').style.display = 'block';
          document.getElementById('loading-state').style.display = 'none';
          document.getElementById('error-message').style.display = 'block';
          document.getElementById('error-message').textContent = error.message || 'Login failed. Please try again.';
        }
      });

      // Update cart count
      function updateCartCount() {
        const count = cart.getCartCount();
        const badge = document.getElementById('cart-count');
        if (count > 0) {
          badge.textContent = count;
          badge.style.display = 'flex';
        } else {
          badge.style.display = 'none';
        }
      }

      updateCartCount();
    </script>
  </body>
</html>
