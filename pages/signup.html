<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Sign Up - ScentsBymotun" />
    <title>Sign Up - ScentsBymotun</title>
    <link rel="stylesheet" href="../css/style.css" />
    <script src="https://js.paystack.co/v1/inline.js"></script>
  </head>
  <body>
    <!-- Header & Navigation -->
    <header>
      <div class="container">
        <nav class="flex justify-between items-center">
          <a href="../index.html" class="logo">ScentsBymotun</a>

          <ul class="nav-menu">
            <li><a href="../index.html">Home</a></li>
            <li><a href="shop.html">Shop</a></li>
            <li><a href="../index.html#contact">Contact</a></li>
          </ul>

          <div class="nav-actions">
            <a href="cart.html" class="cart-icon" title="Shopping Cart">
              üõçÔ∏è
              <span class="cart-count" id="cart-count" style="display: none">0</span>
            </a>
          </div>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main>
      <section>
        <div class="container-sm">
          <h1 style="text-align: center; margin-bottom: 2rem">Create Your Account</h1>

          <div class="card p-6">
            <!-- Success Message -->
            <div id="success-message" style="display: none" class="alert alert-success mb-4">
              Account created successfully! Redirecting to login...
            </div>

            <!-- Error Message -->
            <div id="error-message" style="display: none" class="alert alert-error mb-4"></div>

            <!-- Loading State -->
            <div id="loading-state" style="display: none; text-align: center; padding: 2rem">
              <p>Creating your account...</p>
            </div>

            <!-- Form -->
            <form id="signup-form" style="display: block">
              <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required placeholder="you@example.com" />
              </div>

              <div class="form-group">
                <label for="password">Password</label>
                <input
                  type="password"
                  id="password"
                  name="password"
                  required
                  placeholder="At least 8 characters"
                  minlength="8"
                />
              </div>

              <div class="form-group">
                <label for="password-confirm">Confirm Password</label>
                <input
                  type="password"
                  id="password-confirm"
                  name="password-confirm"
                  required
                  placeholder="Confirm your password"
                />
              </div>

              <div class="form-group">
                <label style="display: flex; gap: 0.5rem; align-items: center; font-weight: normal">
                  <input type="checkbox" id="terms" required />
                  <span>I agree to the Terms of Service and Privacy Policy</span>
                </label>
              </div>

              <button type="submit" class="btn btn-gold btn-lg btn-block mb-3">Create Account</button>

              <p style="text-align: center; color: var(--text-secondary)">
                Already have an account?
                <a href="login.html" style="color: var(--secondary); font-weight: 600">Login here</a>
              </p>

              <p style="text-align: center; color: var(--text-secondary); margin-top: 1rem; font-size: 0.875rem">
                <a href="../index.html" style="color: var(--secondary)">‚Üê Back to home</a>
              </p>
            </form>
          </div>

          <!-- Info Section -->
          <div class="card p-4 mt-4" style="background-color: var(--bg-secondary)">
            <h3 style="margin-bottom: 1rem">Why Create an Account?</h3>
            <ul style="list-style: none; padding: 0; margin: 0">
              <li style="margin-bottom: 0.5rem">‚úì Track your orders and delivery status</li>
              <li style="margin-bottom: 0.5rem">‚úì Save your favorite fragrances</li>
              <li style="margin-bottom: 0.5rem">‚úì Faster checkout process</li>
              <li>‚úì Exclusive member-only offers and promotions</li>
            </ul>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer style="margin-top: 4rem">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h4>ScentsBymotun</h4>
            <p>Premium luxury fragrances for the discerning individual.</p>
          </div>

          <div class="footer-section">
            <h4>Quick Links</h4>
            <a href="shop.html">Shop</a>
            <a href="#about">About Us</a>
            <a href="#returns">Returns</a>
          </div>

          <div class="footer-section">
            <h4>Customer Service</h4>
            <a href="mailto:support@scentsbymotun.com">Email Support</a>
            <a href="tel:+2341234567890">Call Us</a>
            <a href="#faq">FAQ</a>
          </div>

          <div class="footer-section">
            <h4>Follow Us</h4>
            <div class="social-links">
              <a href="https://instagram.com/scentsbymotun" target="_blank" title="Instagram">üì∑</a>
              <a href="https://twitter.com/scentsbymotun" target="_blank" title="Twitter">ùïè</a>
              <a href="https://facebook.com/scentsbymotun" target="_blank" title="Facebook">f</a>
            </div>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; 2024 ScentsBymotun. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script type="module">
      import { auth } from '../js/auth.js';
      import { cart } from '../js/cart.js';

      // [v0] Initialize signup page
      console.log('[v0] Signup page initializing');

      const form = document.getElementById('signup-form');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const passwordConfirm = document.getElementById('password-confirm').value;

        // Validation
        if (password !== passwordConfirm) {
          document.getElementById('error-message').style.display = 'block';
          document.getElementById('error-message').textContent = 'Passwords do not match';
          return;
        }

        if (password.length < 8) {
          document.getElementById('error-message').style.display = 'block';
          document.getElementById('error-message').textContent = 'Password must be at least 8 characters';
          return;
        }

        try {
          document.getElementById('signup-form').style.display = 'none';
          document.getElementById('loading-state').style.display = 'block';
          document.getElementById('error-message').style.display = 'none';

          await auth.signUp(email, password);

          console.log('[v0] Signup successful');

          document.getElementById('loading-state').style.display = 'none';
          document.getElementById('success-message').style.display = 'block';

          // Redirect to login after 2 seconds
          setTimeout(() => {
            window.location.href = 'login.html';
          }, 2000);
        } catch (error) {
          console.error('[v0] Signup error:', error);

          document.getElementById('signup-form').style.display = 'block';
          document.getElementById('loading-state').style.display = 'none';
          document.getElementById('error-message').style.display = 'block';
          document.getElementById('error-message').textContent = error.message || 'Signup failed. Please try again.';
        }
      });

      // Update cart count
      function updateCartCount() {
        const count = cart.getCartCount();
        const badge = document.getElementById('cart-count');
        if (count > 0) {
          badge.textContent = count;
          badge.style.display = 'flex';
        } else {
          badge.style.display = 'none';
        }
      }

      updateCartCount();
    </script>
  </body>
</html>
